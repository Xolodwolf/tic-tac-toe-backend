# Tic-Tac-Toe Backend

–ë—ç–∫–µ–Ω–¥ –¥–ª—è –∏–≥—Ä—ã "–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏" (Tic-Tac-Toe), —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ Python. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–≥—Ä—ã "–ò–≥—Ä–æ–∫ –ø—Ä–æ—Ç–∏–≤ –ò–≥—Ä–æ–∫–∞" (PvP) –∏ "–ò–≥—Ä–æ–∫ –ø—Ä–æ—Ç–∏–≤ –ö–æ–º–ø—å—é—Ç–µ—Ä–∞" (PvC), –∞ —Ç–∞–∫–∂–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

*   **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:** Python 3
*   **–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫:** Flask
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
*   **ORM:** SQLAlchemy
*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT (Flask-JWT-Extended)

## üóÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ PostgreSQL.

1.  –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω PostgreSQL.
2.  –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –∏–º–µ–Ω–µ–º `tictac_backend`:
3.  –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `src/datasource/database.py`:
    ```python
    DATABASE_URL = os.getenv(
        "DATABASE_URL", "postgresql://user:password@localhost:5432/tictac_backend"
    )
    ```
    –ï—Å–ª–∏ –≤–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ø–∞—Ä–æ–ª—å, —Ö–æ—Å—Ç), –∏–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ –Ω–∞ –≤–∞—à–µ.

–¢–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ API

### üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`/auth`)

*   **POST** `/auth/register`
    *   –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    *   –¢–µ–ª–æ: `{"login": "...", "password": "..."}`
*   **POST** `/auth/login`
    *   –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `access_token` –∏ `refresh_token`.
    *   –¢–µ–ª–æ: `{"login": "...", "password": "..."}`
*   **POST** `/auth/refresh-access`
    *   –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–µ–≥–æ access —Ç–æ–∫–µ–Ω–∞.
    *   –¢–µ–ª–æ: `{"refresh_token": "..."}`
*   **POST** `/auth/refresh`
    *   –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤ (access –∏ refresh).
    *   –¢–µ–ª–æ: `{"refresh_token": "..."}`
*   **GET** `/auth/me`
    *   –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.
    *   –ó–∞–≥–æ–ª–æ–≤–æ–∫: `Authorization: Bearer <access_token>`

### üéÆ –ò–≥—Ä–æ–≤–æ–π –ø—Ä–æ—Ü–µ—Å—Å (`/game`)

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∏–∂–µ —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <access_token>`.

*   **POST** `/game/create`
    *   –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã.
    *   –¢–µ–ª–æ: `{"game_type": "pvp" | "pvc"}`
*   **GET** `/game/available`
    *   –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä, –æ–∂–∏–¥–∞—é—â–∏—Ö –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞ (—Å—Ç–∞—Ç—É—Å `waiting_for_player`).
*   **POST** `/game/<game_id>/join`
    *   –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ –≤—Ç–æ—Ä–æ–º—É –∏–≥—Ä–æ–∫—É –≤ PvP –∏–≥—Ä–µ.
*   **POST** `/game/<game_id>/move`
    *   –°–æ–≤–µ—Ä—à–µ–Ω–∏–µ —Ö–æ–¥–∞.
    *   –¢–µ–ª–æ: `{"board": [[...], [...], [...]]}` (–º–∞—Ç—Ä–∏—Ü–∞ 3x3, –æ–ø–∏—Å—ã–≤–∞—é—â–∞—è —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—è —Å —É—á–µ—Ç–æ–º —Ö–æ–¥–∞)
*   **GET** `/game/<game_id>`
    *   –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã –ø–æ ID.
*   **GET** `/game/history`
    *   –ò—Å—Ç–æ—Ä–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∏–≥—Ä —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
*   **GET** `/game/leaderboard`
    *   –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤ (–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤ –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é –ø–æ–±–µ–¥).
    *   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `?limit=10` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10).

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/user`)

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∏–∂–µ —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <access_token>`.

*   **GET** `/user/<user_id>`
    *   –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ –µ–≥–æ ID.
